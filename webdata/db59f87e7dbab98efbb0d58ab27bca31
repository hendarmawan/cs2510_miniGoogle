<html>

<head>
<title>CS2310 XML Based Servers</title>
<!--mstheme--><link rel="stylesheet" href="ice1011.css">
<meta name="Microsoft Theme" content="ice 1011">
</head>
<a href="pg7.htm"> <img src="previous.gif" align=left></a><a href="index.html" > </a>
<a href="pg9.htm"> <img src="next.gif" align=right ></a><a href="pg1.html" > </a>
 
<center> 
<h1>Message Server Client</h1>
</center>
<body>

<div style="border-style: double; border-width: 3px">
	<p align="justify"><code>public void send() throws IOException {</code></p>
	<blockquote>
		<p align="justify"><code>Socket socket = null;<br>
		PrintWriter out = null;<br>
		BufferedReader in = null;<br>
		<br>
		socket = new Socket(host, portNumber);<br>
		out = new PrintWriter(socket.getOutputStream(), true);<br>
		in = new BufferedReader(new InputStreamReader(socket.getInputStream()));<br>
		<br>
		Message m = new Message();<br>
		m.setStatus(status);<br>
		m.setCommand(command);<br>
		m.setQueueName(queueName);<br>
		m.setProcessingRule(processingRule);<br>
		m.setMessageId(messageId);<br>
		m.setPayload(payload);<br>
		<br>
		//protocol stipulates that the the message<br>
		//length will be followed by a new line character<br>
		//which will be followed by the message<br>
		out.println(m.toString().length()); <br>
		out.println(m.toString());<br>
		<br>
		//read server's reply<br>
		StringBuffer sb = new StringBuffer();<br>
		String line = in.readLine();<br>
		while (line != null) {<br>
		sb.append(line);<br>
		line = in.readLine();<br>
		}<br>
		<br>
		reply = new Message(sb.toString());<br>
		<br>
		out.close();<br>
		in.close();<br>
		socket.close();</code></p>
	</blockquote>
	<p align="justify"><code>} </code></div>

</body>

<body>

</body>

</html>
