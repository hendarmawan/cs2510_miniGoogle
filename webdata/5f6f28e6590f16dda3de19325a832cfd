<title>About dBase IV</title>
<h1>About dBase IV</h1>

<h2>To download dBase IV</h2>
Please use anonymous ftp to download
/afs/cs.pitt.edu/public/chang/db4.zip
<p>
Once you unzip it, you can immediately start to use it
by typing "dbase".<br>
This version is for exercises only and should be deleted once
you have completed the exercises.
<p>
You can also use DBASE III or DBASE III Plus
for the homework if you already have.
<p>

<h2>To Use dBase IV in CIS Lab</h2>
You can use DBASE IV from Forbes Quadrangle CIS Computing Lab.
<p>
Follow the main menu to invoke DBASE IV.
Or type "dbase4" directly from DOS prompt.
<p>
To use your own diskette, change to A: drive
before invoking DBASE IV, or issue the following
command in the command mode of DBASE IV, "SET DEFAULT TO A:" 
<p>

<h2>HELP?</h2>
Use on-line HELP facility to learn DBASE, or consult any DBASE textbook.
<p>

<hr>

<H1>About dBase Homework</H1>
<ol>
<li>Turn in a diskette, together with your homework.  It MUST contain:
<br>
<ul>
<li>README file to describe contents of the diskette;
<li>relevant information and files from which you get the result of the homework.<br>
The relevant files may include database files (DBF, MDX, NDX, etc.),
view queries (QBE), and program file (PRG).
</ul>
<p>
<li>Hard copies of these files SHOULD also be available.
The hard copies of database files should consist of both structure and data.
<p>
<li> Put everything in a big manila envelope and write your name on the envelope.
</ol>
<p>

<hr>

<h1>Two Ways to Use dBase IV </h1>
<ul>
<li> Menu-driven Mode (Control Center)
<li> Command-driven Mode (dot prompt)
</ul>
<p>

<hr>

<h1>Control Center</h1>
At DOS, input "dbase" to enter the control center.
<p>

Control center: <br>
<IMG SRC="dBase4/f23.gif">
<p>

There are six panels in the control center: 
<ul>
<li> Data panel 
<li> Queries panel
<li> Forms panel 
<li> Reports panel 
<li> Labels panel 
<li> Applications panel 
</ul>
<p>

<hr>

<h1>Data Panel</h1>
<p>
In dBase, every DBF file (*.dbf) is considered to be a seperate database, the relations
between databases are linked by programs. <br>
(Note: in SQL, a database is a group of tables, the relationships between
tables are considered as a part of the group.)
<p>

<h2>Design the Database Structure</h2>
Click the &lt create&gt in the Data panel. <br>
A database is composed of fields.<br>
There are six field types:
<ul>
<li>Character
<li>Numeric
<li>Float
<li>Date  (mm/dd/yy)
<li>Logical (T/F)
<li>Memo (point to a file)
</ul>

Database design screen (before): <br>
<IMG SRC="dBase4/f24.gif">
<p>
Database design screen (after): <br>
<IMG SRC="dBase4/f25.gif">
<p>

<h2>Enter Records to the Database</h2>
Click the database file and select &quot Use file &quot. <br>
Press function key &lt F2&gt to enter or switch between Edit and
Browse screens.<br>
(You can use TAB, PGUP, PGDN keys to move in the screen.) <br>
In Edit screen, you can enter records. <br>
In Browse screen, you can browse records. <br>
<p>

Enter data to the edit screen: <br>
<IMG SRC="dBase4/f28.gif">
<p>
Record shown in the browse screen: <br>
<IMG SRC="dBase4/f210.gif">
<p>

<h2>Add, Modify, and Delete Record</h2>
Enter Edit or Browse screens. <br>
Select Add/Delete option in Records menu in the Edit/Browse screen. <br>
Modify record in the Edit screen. <br>

<h2>Change Database Structure</h2>
Click the database file and select &quot Modify structure/order &quot. <br>

<p>
<hr>

<h1>Queries Panel</h1>
A query design, or view, can be save as a file (*.QBE).<br>
A QBE file is associated with a DBF file, which is defined in the Data Panel.

<ul>
<li> Specify a query
<li> Select fields
</ul>

Query design screen: <br>
<IMG SRC="dBase4/f32.gif">
<p>

<h2>Specify a Query</h2>
<ul>
<li> Exact Match Searches
<li> Soundex Searches
<li> Contains Match Searches
<li> Pattern Match Searches <br>
     (wildcard character *, ?)
<li> Condition Match Searches <br>
     (operators =, <> or #, >, <, <=, >=)
</ul>

and (in the same row): <br>
<IMG SRC="dBase4/f313.gif">
<p>
or (in different rows, use UP/DOWN keys to move):  <br>
<IMG SRC="dBase4/f314.gif">
<p>
Soundex Searches: <br>
<IMG SRC="dBase4/f39.gif">
<p>
Contains Match Searches: <br>
<IMG SRC="dBase4/f311.gif">
<p>
Pattern Match Searches: <br>
<IMG SRC="dBase4/f310.gif">
<p>
Condition Match Searches: <br>
<IMG SRC="dBase4/f312.gif">
<p>

<h2>Select Fields</h2>
Use function key &lt F5&gt to select/erase fields in the query design.
<p>

LASTNAME selected into the view: <br>
<IMG SRC="dBase4/f38.gif">
<p>

<h2>See the Result</h2>
Use function key &lt F2&gt to bring up the browse/edit screen and see the
searching result of your query.
<p>
<hr>
<h1>Using dBase IV Command and Programming</h1>

<h1>dBase IV Command Mode</h1>
<h2>Enter and Quit</h2>
At the control center, select "Exit to dot prompt" in Exit menu to
enter the command mode.<br>
Enter command "ASSIST" to go back to the control center.  <p>

<hr>

<h1>Programming Using dBase IV Command Language</h1>
A database program is named *.prg <br>
In the control center, click the program and choose "run application" at the Application panel to run a program. <p>

<hr>

<h1>Syntax of a Command Line</h1>
The syntax of dBase IV a command line is like: <p>
   verb [scope][expression][FOR condition][WHILE condition]
<p>

<ul>
<li> verb: command
<li> scope: Indicates which record(s) will be affected <br>
   <ul>
      <li>ALL
      <li>NEXT number
      <li>REST
      <li>RECORD number
   </ul>
<li> expression: a list of the fields or other parameters of the command
<li> condition: =, <> or #, >, <, <=, >=, .T., .F., .NOT., .AND., .OR.
</ul>

e.g. LIST NEXT 10 Firstname, Lastname, FOR City = "Pittsburgh" <br>
which means that, starting from the current record point,
list the next 10 records which match the given condition City = "Pittsburgh".<p>
(Note: keywords are represented by capital letters in this document.) <p>

<hr>

<h1>dBase IV Commands</h1>
<h2>On-line Help</h2>
<dl>
<dt>HELP 		<dd> invoke the on-line help <p>
<dt>HELP command	<dd> describe the syntax of the command <p>
</dl>

<h2>Open and Display Database Files</h2>
<dl>
<dt>USE database_file	<dd> open the database file <p>
<dt>DISPLAY STRUCTURE	<dd> display the database structure <p>
<dt>DISPLAY [scope][expression][FOR/WHILE condition] <dd> display records <p>
<dt>LIST [scope][expression][FOR/WHILE condition] <dd> display records <p>
<dt>LIST [scope][expression] TO FILE filename <dd>output records to a file <p>
</dl>

<h2>Move Record Pointer </h2>
<dl>
<dt>SKIP [number] <dd> positive#: forward; <br> negative#: backward <p>
<dt>GO number     <dd> move the record pointer to the record number<p>
<dt>GO TOP        <dd> move the record pointer to the first record<p>
<dt>GO BOTTOM     <dd> move the record pointer to the last record<p>
<dt>LOCATE [scope][FOR/WHILE condition] <dd> move the record pointer to a record that satisfies the condition <p>
<dt>CONTINUE      <dd> locate the next record <p>
</dl>

<h2>Edit Records</h2>
<dl>
<dt>EDIT [scope][condition] <dd> modify records <p>
<dt>BROWSE <dd> browse records <p>
<dt>REPLACE [scope] field WITH value FOR condition <dd> change the value of a field<p>
<dt>APPEND <dd> add records to the end of a database <p>
<dt>DELETE <dd> mark records for deletion <p>
<dt>PACK <dd> remove marked records from database file <p>
</dl>

<h2>Set Commands</h2>
<dl>
<dt>SET <dd> display a menu for changing the value of many set commands<p>
<dt>SET FIELD TO [field list] <dd> set a list of fields tha can be accessed <p>
<dt>SET FIELD TO  <dd> turn of previous setting <p>
<dt>SET FILTER TO [condition] <dd> display only records that meets a condition <p>
<dt>SET FILTER TO  <dd> turn of previous setting <p>
</dl>
Note: you can find more SET commands in the on-line help <p>

<h2>Indexing and Sorting</h2>
<dl>
<dt>INDEX [ON expression] [TAG tag_name] <dd> create an index tag tag_name in
which records are ordered alphabetically, numerically, or chronologically;
tag_name is saved into an index file *.MDX  <p>
<dt>?ORDER() <dd> return current tag_name <p>
<dt>SET ORDER TO tag_name <dd> set to the index tag tag_name <p>
</dl>

<h2>Searching with an Indexed File</h2>
<dl>
<dt>SEEK expression <dd> search a record in an indexed database file (set index tag before use SEEK)<p>
</dl>

<h2>Working with Multiple Database Files</h2>
A database file is opened in a work area.
You can open up to 10 work areas (named by number from 1 to 10 or alias name)
at one time.  But only one of the work areas can be active at any time. <br>
The default work area is 1. <p>
<dl>
<dt>USE database_file <dd> open a database file at the current work area<p>
<dt>USE database_file ALIAS alias_name <dd> open a database file at the work area alias_name<p>
<dt>SELECT number/alias <dd> move to and activate work area number or alias<p>
<dt>CLOSE ALL/file_type <dd> close all files/all file type listed <p>
<dt>SET RELATION TO expression INTO work_area#/alias_name <dd> link the active 
database to open a database in another work area <p>
</dl>

<h2>Display Messages and Get Input into a Variable</h2>
<dl>
<dt>? expression <dd> display an expression <p>
<dt>INPUT [expression] TO variable <dd> display an expression and assign input into a variable. <p>
<dt>@ <row,col> SAY [expression] [GET variable]	<dd> display an expression and assign input into a variable.  <p>
<dt>READ <dd>activate the SAY command; READ follows the SAY command to do so<p>
</dl>

There are 4 variable types: <br>
<ul>
<li> character
<li> numeric
<li> logical
<li> date
</ul>

<h2> Creating a Loop</h2>
<dl>
<dt>DO WHILE condition 
<dt>   <dd>... 
<dt>ENDDO <p>
</dl>

<h2>Conditional Statements</h2>
<dl>
<dt>IF condition <br>
<dt>   <dd>... <br>
<dt>ENDIF <p>
</dl>

<dl>
<dt>DO CASE  <br>
<dt>   <dd>CASE condition <br>
                ... <br>
<dt>   <dd>CASE condition <br>
                ... <br>
                ... <br>
<dt>ENDCASE <p>
</dl>

<h2>About Date</h2>
var_days = var_date1 - var_date2 <br>
returns the number of days between two dates. <p>

Use on-line help to find more commands. <p>

<hr>

<h1>dBase IV Functions</h1>
<dl>
<dt>EOF() <dd> return a true value .T. or a false value .F.; decide whether the record pointer is located at the end of the database file<p>
<dt>DATE() <dd> return the current date in the computer <p>
<dt>DTOC() <dd> transfer a variable of type date into a character string <p>
</dl>

More functions can be found in the on-line help <p>

<hr>

<h1> A Sample Program Using dBase IV Command Language</h1>
<pre>
CLEAR
CLEAR ALL
   @ 1,1 SAY 'Select:'
   @ 2,1 SAY 'A: First query'
   @ 3,1 SAY 'B: Second query'
   @ 5,1 SAY 'Q: Quit'
   @ 6,1 SAY 'Enter your selection'
   choice = ' '
   DO WHILE .NOT. UPPER(choice) $ 'ABQ'
      @ 7,1 SAY " -> " GET choice
      READ
   ENDDO
   SET COLOR TO W/N
   CLEAR GETS
   choice = UPPER(choice)
   IF choice='Q'
      CLEAR ALL
      CLEAR
      @ 7,1 SAY "See You next time. Good Luck!"
      EXIT
   ENDIF
   IF choice='A'
      DO query1
      choice = ' '
   ENDIF
   IF choice = 'B'
      DO query2
      choice = ' '
   ENDIF
CLEAR ALL
CLEAR
QUIT
</pre>

<p>

<hr>

<h1>Structured Query Language (SQL)</h1>
Two Modes Using SQL in dBase IV:
<ul>
<li> interactive mode (dot prompt)
<li> embedded mode (programming)
</ul>

<br>

Enter the Interactive Mode:
<dl>
<dt>SET SQL ON <dd>enter SQL language processor  <p>
<dt>SET SQL OFF <dd>leave SQL language processor  <p>
<dl>
