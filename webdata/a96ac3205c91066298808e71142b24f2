<!DOCTYPE html> 
<html>
<head>
	<title>Information for John Ramirez</title>
<script src="http://people.cs.pitt.edu/~ramirez/jquery-1.8.3.js"></script>

<script type="text/javascript">

     $(document).ready(function()
        {  
	   $.ajaxSetup({
		cache: false
	   });
	   $("#waiting").hide();
	   $("#customizing").hide();
	   $("#waiting").addClass("wait");
	   //$("#customizing").addClass("show-settings");
	   iphone = navigator.userAgent.toLowerCase().indexOf("iphone");
	   if (iphone > -1)
	   {
    	      $("<meta name='viewport' content='user-scalable=no, width=device-width'/>").appendTo('head'); 
	      var orient = window.orientation;
	      if (orient == 0)
	      {
	         alert("For Best Results, Use Landscape Mode");
	      }
	   }
	   $("#datatable").addClass("midtable");
	   
	   loadInfo();
        }
     );

function setColorScheme(scheme)
{
	var styleURL = "styles/";;
	var ie7 = navigator.userAgent.toLowerCase().indexOf("msie 7.0");
	var ie8 = navigator.userAgent.toLowerCase().indexOf("msie 8.0");
	if (iphone > -1)
	{
	   styleURL += scheme + "-iphone" + ".css";
	}
	else
	{	
          styleURL += scheme + ".css";
        }
        if (ie7 >= 0 || ie8 >= 0)
	{
           if (hasStyle)
           {
               document.styleSheets[0].disabled = true; 
           }
	   document.createStyleSheet(styleURL,0);
	}
	else
	{
           if (hasStyle)
	   {
	      $("link#thestyle").disabled=true; 
	      $("link#thestyle").remove(); 
	   }
    	   $('<link rel="stylesheet" id="thestyle" type="text/css" href="' + styleURL + '" />').appendTo('head'); 
	}
	hasStyle = true;
}   

function addEvents()
{
           $("#datatable tr").each(function(ind, el)
              {
                 var rowid = datatypes[ind];
                 var url = rowid + ".html";
                 $(this).click(function()
                   {
		      if (opened[ind] == 0)
		      {
			 //$("#clicksound").get(0).play();
		         $("#waiting").show();
		         opened[ind] = 1;
                         var rowAddid = rowid + "-add";
                         var newRow = "<tr id='"+rowAddid+"'>";
		         newRow += "<td class='largeitem' colspan='2'></td>";
                         $("tr#" + rowid).after(newRow);
                         $("tr#" + rowAddid + " td").load(url, function(resp, stat, xhttp) {
			      if (stat == "error")
			      {   $("tr#" + rowAddid + " td").html("<p>Unable to load page.  Please check your internet connection.</p>");
			      }
			      xhttp.onreadystatechange = null;
			      xhttp.abort = null;
			      xhttp = null;
			      $("#waiting").hide();
                         });
                         $("tr#" + rowid + " td").each(function(ind2, el2)
                              {
                                 if (ind2 == 0)
		                 {
                                    $(el2).html('-');
                                    $(el2).removeClass("largeitem");
                                    $(el2).addClass("expanded");
		                 }
                                 else
			         {
			            oldcontents[ind] = $(el2).html();
			            $(el2).html('[Hide ' + names[ind]+']');
                                    $(el2).removeClass("largeitem");
                                    $(el2).addClass("expanded");
			         }
			      }
		         );
		      }
		      else
		      {
		         opened[ind] = 0;
		         var rowRemid = rowid + "-add";
		         $("tr#" + rowRemid).remove();
                         $("tr#" + rowid + " td").each(function(ind2, el2)
                              {
                                 if (ind2 == 0)
		                 {
                                    $(el2).html('+');
                                    $(el2).removeClass("expanded");
                                    $(el2).addClass("largeitem");
		                 }
                                 else
			         {
			            $(el2).html(oldcontents[ind]);
                                    $(el2).removeClass("expanded");
                                    $(el2).addClass("largeitem");
			         }
			      }
		         );
		      }
                   }
                 );
              }
           );
	   $("table#settable").click(function() {
	      addOptions();
	   }
	   );
}

function addOptions()
{
     $.ajax({
	type: "GET",
	url: "options.xml",
	dataType: "xml",
	success: function(xml) {
	   $("#customizing").empty();
	   var options = $(xml).find("option");
	   for (var i = 0; i < options.length; i++)
	   {
	      var theOption = options[i];
	      var theName = $(theOption).find("name").text();
	      var elt = "<button id='" + theName + "'>" + theName + "</button>";
	      $("#customizing").append(elt);
	      $("#customizing").append("<br/>");
	   }
	   $("#customizing button").each(function(ind, el) {
	      var fname = $(el).attr('id');
	      $(el).css({'color': 'Black', 'width': '300px', 'height':'40px', 'padding-top': '10px', 'padding-bottom': '10px'});
	      $(el).click(function() {
		if (fname == "default")
		{
		   setColorScheme("homestyle");
	           localStorage.setItem("ColorScheme", "homestyle");
		}
		else
		{
		   setColorScheme(fname);
	           localStorage.setItem("ColorScheme", fname);
		}
	        $("div#customizing").hide();
		$("div#top").show();
		$("div#middle").show();
		$("div#bottom").show();
	      }
	      );
	   }
	   );	      
	   $("div#top").hide();
	   $("div#middle").hide();
	   $("div#bottom").hide();
	   $("#customizing").show();
	}
     }
     );
}
	
        
function loadInfo()
{
     $("div#top").load("intro.html");
     $.ajax({
	type: "GET",
	url: "info.xml",
	dataType: "xml",
	success: function(xml) {
	   if (typeof(Storage) !== "undefined")
	   {
	      //alert("Local Storage Available");
	      scheme = localStorage.getItem("ColorScheme");
	      if (scheme != null)
	      {
	         //alert("Scheme is " + scheme);
	         setColorScheme(scheme);
	      }
	      else
	      {
		 setColorScheme("homestyle");
	      } 
              var rowString = "<tr id='custom'>";
	      rowString += "<td colspan='2'><img src='settings.jpg' width='32'/></td></tr>";
	      $('#settable').append(rowString);
	   }
	   else
	   {
	      setColorScheme("homestyle");
	   }
	   var theTitle = $(xml).find("title").text();
	   document.title = theTitle;
	   var items = $(xml).find("item");
	   for (var i = 0; i < items.length; i++)
	   {
	      var theItem = items[i];
	      var theName = $(theItem).find("name").text();
	      var theComment = $(theItem).find("comment").text();
	      var theId = $(theItem).find("id").text();
	      datatypes.push(theId);
              opened.push(0);
	      names.push(theName);
	      comments.push(theComment);
              var rowString = "<tr id='"+theId+"'>";
	      rowString += "<td class='largeitem'>" + "+" + "</td>";
	      rowString += "<td class='largeitem'>" + theName + "<p>" + theComment + "</p></td>";
	      rowString += "</tr>";
              $('#datatable').append(rowString);
	   }
           addEvents();
	}
    });
}
</script>
</head>
<body>
	<div id="top" class="title">
	</div>
	<div id="middle">
	   <table id="datatable">
	   <tbody>
	   </tbody>
	   </table>
        </div>
	<div id="bottom">
	   <table id="settable" class="bottable">
	   <tbody>
	   </tbody>
	   </table>
	</div>
	<div id="waiting">
	   <img src="loading.gif" alt="loading" width="50" height="50"/>
	</div>
	<div id="customizing">
	</div>
	<audio id="clicksound" type="audio/wav" preload="auto" src="drum_bass.wav"></audio>
<script type="text/javascript">
        var datatypes = new Array();
        var opened = new Array();
        var oldcontents = new Array();
	var names = new Array();
	var comments = new Array();
        var currstyle="pointer";
        var index;
	var iphone;
	var scheme;
	var hasStyle = false;
</script>
</body>
</html>

